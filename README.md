## PPP Loan Marketing Campaign Data Extraction Utility

## Author
Christopher Morehouse

## Description
This utility uses public company information from a csv file generated from the Paycheck Protection Program (PPP) US Government site and looks up contact information for those companies in Apollo.io. The result of running this utility is an enriched csv file that contains the list of qualified contacts at companies from the original PPP loan csv. These contacts can be used in marketing campaigns for financial services that target ppp loan borrowers.

The input PPP loan csv file can be generated by visiting this site here:

https://www.sba.gov/funding-programs/loans/covid-19-relief-options/paycheck-protection-program/ppp-data

# Behavior of the application:

1. When running the utility, it will use the company name from the PPP loan csv, perform a lookup for the company in Apollo.io, and automatically retrieve contact information for that company.

2. If more than one result is returned, it will display a list of companies with similar names, since the company name in the PPP loan csv could be different from how the company's name appears in Apollo.io.

3. If no results are returned, then the utility will ask you to manually enter a company name that you've verified exists in Apollo.io.
    
4. If the company is not found, then you will have the option to skip it and the utility will proceed to the next company on the list

# Prerequisites:

You'll need to have a valid account with Apollo.io along with an authentication token that the utility will use to lookup and extract data.

To build an executable, you'll need to install dependencies which will include cx_Freeze. cx_Freeze is a tool that turns python scripts into standalone executable binaries. To install dependencies, run: pip install -r /path/to/requirements.txt

You can then execute the build.ps1 powershell script to build the executable.

# Instructions to run the application:

1. Copy the CSV that was exported from the PPP Loan borrower site above and place it in the same directory as main.py. If you built the application then this will be the same folder that the marketing_campaign_data_extraction_utility.exe file is located. 

2. Open the env_config.yaml file with a text editor and make sure all the parameters are correct. The following is a short description of each of the parameters: 

   **apollo_auth_token** – This is the token created in the Apollo platform that the utility uses to authenticate.

   **seniority_level** – The script will only pull contact information for people with the seniority levels listed here. Possible values to use are: owner, founder, c_suite, partner, vp, head, director, manager, senior, entry, intern. 

   **source_file_name** – The name of the CSV file exported from the PPP loan borrower site. 

   **target_file_name** – The name of the enriched CSV file the script will generate. 

3. Save the changes in env_config.yaml and run main.py or double-click the marketing_campaign_data_extraction_utility.exe if you ran the build script. 

4. Follow the on-screen instructions. Once complete, a new CSV file (with the name specified in target_file_name above) will get created in the current directory.

## Build an executable binary for deployment

The preferred method for deployment is to build a self-contained package that includes all the dependencies as well as a run-time environment.
Using this method, users will not have to install python or any dependency libraries. They just edit the env_config.yaml and execute the binary.

cx_Freeze is used to build the binary and will need to be installed first in order to create the deployment package. For more information on cx_Freeze:

Project page: https://pypi.org/project/cx-Freeze/

Project documentation: https://cx-freeze.readthedocs.io/en/latest/

You can install cx_Freeze in a Python environment by running the following command:

```sh
pip install --upgrade cx_Freeze
```

Once cx_Freeze is installed you can continue with building the self-contained package by executing the build script with the following command: 

```sh
./build.ps1
```

A "build" folder will get created that contains the directory with the executable and dependancy library. A zip of the executable directory also gets created.
You can send this zip file to users or wherever the script will be deployed to.
